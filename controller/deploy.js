const caver = require('../caver/caver')
const dotenv = require('dotenv');
dotenv.config();

module.exports = async (req, res) => {
  let tx = {
    from: process.env.USING_ACCOUNT,
    value: '0x0',
    input: "0x608060405234801561001057600080fd5b50336000806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550600180819055506040518060400160405280600681526020017f7066697a65720000000000000000000000000000000000000000000000000000815250600260008060ff16815260200190815260200160002090805190602001906100b792919061017f565b506040518060400160405280600781526020017f6d6f6465726e610000000000000000000000000000000000000000000000000081525060026000600160ff168152602001908152602001600020908051906020019061011892919061017f565b506040518060400160405280600781526020017f6a616e7373656e0000000000000000000000000000000000000000000000000081525060026000600260ff168152602001908152602001600020908051906020019061017992919061017f565b50610283565b82805461018b90610251565b90600052602060002090601f0160209004810192826101ad57600085556101f4565b82601f106101c657805160ff19168380011785556101f4565b828001600101855582156101f4579182015b828111156101f35782518255916020019190600101906101d8565b5b5090506102019190610205565b5090565b5b8082111561021e576000816000905550600101610206565b5090565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b6000600282049050600182168061026957607f821691505b6020821081141561027d5761027c610222565b5b50919050565b610905806102926000396000f3fe608060405234801561001057600080fd5b50600436106100365760003560e01c8063de9fd4381461003b578063fd531e931461006b575b600080fd5b6100556004803603810190610050919061054f565b61009b565b60405161006291906105de565b60405180910390f35b610085600480360381019061008091906105f9565b610213565b604051610092919061074a565b60405180910390f35b60003373ffffffffffffffffffffffffffffffffffffffff1660008054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff161461012b576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610122906107c9565b60405180910390fd5b6000600360008773ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000209050600081600001541461017f57600080fd5b6001548160000181905550338160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508460ff16816002018190555083838260030191906101ec929190610368565b5060018060008282546101ff9190610818565b925050819055506001915050949350505050565b61021b6103ee565b600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020604051806080016040529081600082015481526020016001820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600282015481526020016003820180546102df9061089d565b80601f016020809104026020016040519081016040528092919081815260200182805461030b9061089d565b80156103585780601f1061032d57610100808354040283529160200191610358565b820191906000526020600020905b81548152906001019060200180831161033b57829003601f168201915b5050505050815250509050919050565b8280546103749061089d565b90600052602060002090601f01602090048101928261039657600085556103dd565b82601f106103af57803560ff19168380011785556103dd565b828001600101855582156103dd579182015b828111156103dc5782358255916020019190600101906103c1565b5b5090506103ea919061042c565b5090565b604051806080016040528060008152602001600073ffffffffffffffffffffffffffffffffffffffff16815260200160008152602001606081525090565b5b8082111561044557600081600090555060010161042d565b5090565b600080fd5b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600061047e82610453565b9050919050565b61048e81610473565b811461049957600080fd5b50565b6000813590506104ab81610485565b92915050565b600060ff82169050919050565b6104c7816104b1565b81146104d257600080fd5b50565b6000813590506104e4816104be565b92915050565b600080fd5b600080fd5b600080fd5b60008083601f84011261050f5761050e6104ea565b5b8235905067ffffffffffffffff81111561052c5761052b6104ef565b5b602083019150836001820283011115610548576105476104f4565b5b9250929050565b6000806000806060858703121561056957610568610449565b5b60006105778782880161049c565b9450506020610588878288016104d5565b935050604085013567ffffffffffffffff8111156105a9576105a861044e565b5b6105b5878288016104f9565b925092505092959194509250565b60008115159050919050565b6105d8816105c3565b82525050565b60006020820190506105f360008301846105cf565b92915050565b60006020828403121561060f5761060e610449565b5b600061061d8482850161049c565b91505092915050565b6000819050919050565b61063981610626565b82525050565b61064881610473565b82525050565b600081519050919050565b600082825260208201905092915050565b60005b8381101561068857808201518184015260208101905061066d565b83811115610697576000848401525b50505050565b6000601f19601f8301169050919050565b60006106b98261064e565b6106c38185610659565b93506106d381856020860161066a565b6106dc8161069d565b840191505092915050565b60006080830160008301516106ff6000860182610630565b506020830151610712602086018261063f565b5060408301516107256040860182610630565b506060830151848203606086015261073d82826106ae565b9150508091505092915050565b6000602082019050818103600083015261076481846106e7565b905092915050565b600082825260208201905092915050565b7f4e6f742049737375657200000000000000000000000000000000000000000000600082015250565b60006107b3600a8361076c565b91506107be8261077d565b602082019050919050565b600060208201905081810360008301526107e2816107a6565b9050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600061082382610626565b915061082e83610626565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff03821115610863576108626107e9565b5b828201905092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b600060028204905060018216806108b557607f821691505b602082108114156108c9576108c861086e565b5b5091905056fea2646970667358221220b6039923b10ffd23282e42064a68281b268303953b678c491dc0c23c05d3fef164736f6c634300080a0033",
    gas: 1000000,
    submit: true,
  }
  try{
    const result = await caver().kas.wallet.requestSmartContractDeploy(tx);
    res.send(result);
  }catch(e){
    console.log(e);
    res.send({state: 500})
  }
}